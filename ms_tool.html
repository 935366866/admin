<!DOCTYPE html>
<html>
<head>
    <title>小工具管理界面</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="content-type" content="text/html"; charset="utf-8">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    
    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

<!--表格js--> 
	<link rel="stylesheet" href="css/bootstrap-table.css">   
    <script src="js/bootstrap-table.js"></script>   
<!--文件上传-->
	<link rel="stylesheet" href="css/jquery.fileupload.css">   
    <script src="js/jquery.ui.widget.js"></script> 
    <script src="js/jquery.fileupload.js"></script> 
    <script src="js/jquery.iframe-transport.js"></script> 
<!--jquery form-->
 	<script src="js/jquery.form.js"></script>  
<!--遮罩-->   
	<script src="js/jquery.blockUI.js" type="text/javascript"></script>
<!-- 引入通用的文件 -->
	<script src="js/common.js"></script>
    <script src="js/ms_common.js"></script>
    <link rel="stylesheet" href="css/common.css">   
<!--本页面的js-->
	<script src="js/tool.js"></script>

</head>
<body>
<div class="container-fluid">
<include file='Application/Home/View/navigation.html' />
<!--左侧导航-->
	<div class="col-md-2">
    	<div class="sys_nav_div">
            <h4 style="text-align:center; color:#333">管理系统</h4>
            <div onClick="location.href='ms_user.html'" class="col-md-12 list_style" id="navUser">用户管理</div>
            <div onClick="location.href='ms_tool.html'" class="col-md-12 list_style" id="navApp">小工具管理</div>
            <div onClick="location.href='ms_news.html'" class="col-md-12 list_style" id="navApp">新闻管理</div>
            <div onClick="location.href='ms_right.html'" class="col-md-12 list_style" id="navApp">右侧板块管理</div>
            <div onClick="location.href='ms_goods.html'" class="col-md-12 list_style" id="navApp">商品管理</div>
            <div onClick="location.href='ms_order.html'" class="col-md-12 list_style" id="navApp">订单管理</div>
            <div onClick="location.href='ms_information.html'" class="col-md-12 list_style" id="navApp">消息推送</div>
        </div>
	</div>

<!--左侧导航结束-->    
<!--账号管理-->
	<div class="col-md-10" >
    <!-----------------------工具列表---------------------->
		<div id="appListDiv" class=" panel panel-default container col-md-12" >
                        <div id="appListToolbar">
                        	<p class="col-md-7" style="font-size: 16px; padding-left:0px; padding-right:0px;">工具列表<span style="font-size:12px;">（双击行，可以编辑工具参数等）</span></p>
                            <button class="btn btn-primary col-md-2 " id="addApp" >
                                新增&nbsp;&nbsp;<i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-plus"></i>
                            </button>
                            <button class="btn btn-success col-md-2 " style="margin-left:20px" id="editApp" >
                                编辑&nbsp;&nbsp;<i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-edit"></i>
                            </button>
                          
                        </div>

                    <table data-toggle="table"
                               data-url="__MODULE__/Admin/listTools"
                    			   data-side-pagination="server"
                               data-toolbar="#appListToolbar"
                               data-search="true"
                               data-click-to-select="true"
                               data-show-refresh="true"
                               data-show-columns="true"
                               data-height="350"
                               
                               data-minimum-count-columns="2"
                               data-show-pagination-switch="true"
                               data-pagination="true"
                               data-page-list="[10, 25, 50, 100, ALL]"
                               data-show-footer="false"
                               style="overflow-x:hidden;"
                         		id="appListTable"
                               >
                        <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="id"  data-visible="false">id</th>
                            <th data-field="tool_icon"  data-sortable="true" data-width="16%" data-class="appList_hide">图标</th>
                            <th data-field="tool_name" data-align="center" data-width="12%" data-sortable="true">工具名</th>
                            <th data-field="cat_name"  data-align="center" data-width="12%" data-sortable="true">类别</th>
                            <th data-field="program_path" data-sortable="true" data-align="center" data-width="20%" data-class="appList_hide">程序路径</th>
                            <th data-field=instruction_path data-align="center" data-sortable="true" data-width="20%" data-class="appList_hide">使用文档</th>
                            <th data-field="tool_abstract" data-align="center" data-sortable="true" data-width="20%" data-class="appList_hide">工具介绍</th>
                        </tr>
                        </thead>
                    </table>
                    
                      <!-- <p>已选中<span id="appList_ck_num">0</span>项</p>  -->  
                    
                    </div>
    <!-----------------------工具列表结束---------------------->
    <!-----------------------工具类别管理---------------------->
 	   <div id="appTypeListDiv" class=" panel panel-default container col-md-12">
                        <div id="typeToolbar">
                           
                          <p class="col-md-7" style="font-size: 16px; padding-left:0px; padding-right:0px;"><b>工具类别管理</b><span style="font-size:12px;">（双击行，可以管理工具分类等）</span></p>
                            <button class="btn btn-primary col-md-2 " id="addAppType" >
                                新增&nbsp;&nbsp;<i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-plus"></i>
                            </button>
                            <button class="btn btn-success col-md-2 " style="margin-left:20px" id="editAppType" >
                                编辑&nbsp;&nbsp;<i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-edit"></i>
                            </button>
                        </div>

                    <table data-toggle="table"
                               data-url="__MODULE__/Admin/listToolCatalog"
                               data-side-pagination="server"
                               data-toolbar="#typeToolbar"
                               data-search="true"
                               data-click-to-select="true"
                               data-show-refresh="true"
                               data-height="350"
                               data-show-columns="true"
                               data-show-pagination-switch="true"
                               data-pagination="true"
                               data-page-list="[10, 25, 50, 100, ALL]"
                               data-show-footer="false"
                               
                         		id="appTypeListTable"
                               >
                        <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true"></th>
                            <th data-field="cat_id"  data-visible="false">id</th>
                            <th data-field="cat_icon" data-sortable="false" >图标</th>
                            <th data-field="cat_name" data-align="center" data-sortable="true">类别名</th>
                            <th data-field="cat_remark"  data-align="center" data-sortable="true">描述</th>
                        </tr>
                        </thead>
                    </table>
                    
                    <!--     <p >已选中<span id="appType_ck_num">0</span>项</p>  -->
                    
                    </div>
    <!-----------------------工具类别管理结束--------------------->
	</div>
<!------------------------------工具列表的编辑和新建模态框（form）------------------------------------->                
        <div class="modal fade" id="appListModal" tabindex="-1" role="dialog"  aria-labelledby="appListModalLabel" aria-hidden="true">
           <div class="modal-dialog">
              <div class="modal-content col-md-10 col-md-push-1">
                 <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                          &times;
                    </button>
                    <h4 class="modal-title">
                       添加工具
                    </h4>
                 </div>

                 <div class="modal-body" style=" text-align:center">
              <form style="text-align:left" id="appListForm" class="form-horizontal" role="form" action="__MODULE__/Admin/addUpdateTool" method="post" >
<!-----------模态框的表格------------->
			<input type="text"  class="form-control input-sm" style="display:none;" id="id" name="id">
			<div class="form-group user_form_height">
                <label class="col-sm-3 user_label">图标</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="tool_icon" name="tool_icon">
                </div>
                <!--上传文件-->
                <span class="btn btn-success btn-sm fileinput-button col-md-2" style="width: 60px;">
                    <i class="glyphicon glyphicon-upload"></i>
                    <span>上传</span>
                    <input id="uploadAppIcon" type="file" name="uploadAppIcon">
                </span>
                <!--上传文件结束-->
               
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">工具名</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="tool_name" name="tool_name">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">程序路径</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="program_path" name="program_path">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">使用文档</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="instruction_path" name="instruction_path">
                </div>
                <!--上传文件-->
                <span class="btn btn-success fileinput-button btn-sm col-md-2" style="width: 60px;">
                    <i class="glyphicon glyphicon-upload"></i>
                    <span>上传</span>
                    <input id="uploadAppDocument" type="file" name="uploadAppDocument">
                </span>
                <!--上传文件结束-->
            </div>
            
            <div class="form-group">
                <label class="col-sm-3 user_label">工具介绍</label>
                <div class="col-sm-7">
                <textarea class="form-control" rows="3" id="tool_abstract" name="tool_abstract"></textarea>
                </div>
            </div>
  

           
            
		 <div class="modal-footer">
             
            <button type="submit" id="submitApp"  class="btn btn-primary">
            	提交
            </button>
            <button type="button" id="cancel" class="btn btn-default" data-dismiss="modal">
               取消
            </button>
         </div>
<!-----------模态框的表格结束------------->                
                     </form>
                 </div>   
              </div>
        </div>
        </div>
<!---------------------------------模态框结束---------------------------------------------> 
<!------------------------------双击工具列表的项，出现该工具的参数的模态框（table）------------------------------------->                
        <div class="modal fade" id="appParamsModal" tabindex="-1" role="dialog"  aria-labelledby="appParamsModalLabel" aria-hidden="true">
          	<input type='hidden' id='toolId' name='toolId'></input>
           <div class="modal-dialog"   style="width: 1100px">
              <div class="modal-content col-md-10 col-md-push-1">
                 <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                          &times;
                    </button>
                    <h4 class="modal-title" id="dbParamName">
                       
                    </h4>
                 </div>

                 <div class="modal-body" style=" text-align:center">
                     <div id="appParamsDiv" class=" panel panel-default container col-md-12">
                        <div id="appParamsToolbar">
                        	<p class="col-md-3" style="font-size: 15px; padding-left:0px; padding-right:0px; text-align:left;">工具参数管理</p>
                            <button class="btn btn-primary col-md-2 " id="addAppParam" >
                                新增&nbsp;&nbsp;<i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-plus"></i>
                            </button>
                            <button class="btn btn-success col-md-2 " style="margin-left:20px" id="editAppParam" >
                                编辑&nbsp;&nbsp;<i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-edit"></i>
                            </button>
                          
                        </div>

                    <table data-toggle="table"
                    		   data-url="__MODULE__/Admin/listToolParams"
                    		   
                               data-toolbar="#appParamsToolbar"
                               data-search="true"
                               data-click-to-select="true"
                               data-show-refresh="false"
                               data-height="380"
                               data-side-pagination="server"
                               data-show-pagination-switch="true"
                               data-pagination="true"
                               data-page-list="[10, 25, 50, 100, ALL]"
                               data-show-footer="false"
                               
                         id="appParamsTable"
                               >
                        <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true" ></th>
                            <th data-field="pid" data-align="center" data-visible="false">pid</th>
                            <th data-field="param_name" data-align="center" data-sortable="true" data-width="110" data-class="appParams_hide" > 参数名</th>
                            <th data-field="param_desc" data-align="center" data-width="110"  data-sortable="true" data-class="appParams_hide" >参数描述</th>
                            <th data-field="param_prefix"  data-align="center" data-width="100" data-sortable="true" data-class="appParams_hide">参数前缀</th>
                            <th data-field="default_value" data-sortable="true" data-width="100" data-align="center" data-class="appParams_hide">默认值</th>
                            <th data-field="param_type" data-align="center" data-sortable="true" data-formatter="param_type" data-width="100" data-class="appParams_hide">参数类型</th>
                            <th data-field="sel_val" data-align="center" data-width="100" data-sortable="true" data-class="appParams_hide">可选值</th>
                            <th data-field="element_order" data-align="center" data-width="100" data-sortable="true"  data-class="appParams_hide">顺序</th>
                        	<th data-field="flag" data-align="center" data-width="100"  data-formatter="param_mark" data-sortable="true" data-class="appParams_hide">标志</th>
                        </tr>
                        </thead>
                    </table>
                    
                   <!--   <p style="text-align:left;">已选中<span id="appParams_ck_num">0</span>项</p>  -->   
                    
                    </div>
                 </div>   
              </div>
        </div>
        </div>
<!---------------------------------模态框结束---------------------------------------------> 
<!------------------------------工具参数的新建和编辑模态框（form）------------------------------------->                
       <div class="modal fade" id="appParamModal" tabindex="-1" role="dialog"  aria-labelledby="appListModalLabel" aria-hidden="true">
           <div class="modal-dialog">
              <div class="modal-content col-md-10 col-md-push-1">
                 <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                          &times;
                    </button>
                    <h4 class="modal-title">
                       工具参数
                    </h4>
                 </div>

                 <div class="modal-body" style=" text-align:center">
          <form style="text-align:left" id="appParamForm" class="form-horizontal" role="form" action="__MODULE__/Admin/modifyToolParam" method="post" >
<!-----------模态框的表格------------->
			<input type="text"  class="form-control input-sm" style="display:none;" id="tool_id" name="tool_id">
			<input type="text"  class="form-control input-sm" style="display:none;" id="pid" name="pid">
			<div class="form-group user_form_height">
                <label class="col-sm-3 user_label">参数名</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="param_name" name="param_name">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">参数描述</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="param_desc" name="param_desc">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">参数前缀</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="param_prefix" name="param_prefix">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">默认值</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" id="default_value" name="default_value">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">参数类型</label>
                <div class="col-sm-7">
                    <select id="param_type" class="form-control input-sm" required name="param_type">
                        <option value="text">文本</option>
                        <option value="number">数字</option>
                        <option value="select">下拉框</option>
                        <option value="dir">目录</option>
                        <option value="upload">上传</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">可选值</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" id="sel_val" name="sel_val">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">顺序</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="element_order" name="element_order">
                </div>
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">标志</label>
                <div class="col-sm-7">
                    <select id="flag" class="form-control input-sm" required name="flag">
                        <option value="1">必填</option>
                        <option value="0">选填</option>
                        <option value="-1">禁用</option>
                    </select>
                </div>
            </div>
  

           
            
		 <div class="modal-footer">
             
            <button type="submit" id="submitAppParam"  class="btn btn-primary">
            	提交
            </button>
            <button type="button" id="cancel" class="btn btn-default" data-dismiss="modal">
               取消
            </button>
         </div>
<!-----------模态框的表格结束------------->                
                     </form>
                 </div>   
              </div>
        </div>
        </div>
<!---------------------------------模态框结束--------------------------------------------->  
<!------------------------------工具类型的新建和编辑模态框（form）------------------------------------->                
       <div class="modal fade" id="appTpyeModal" tabindex="-1" role="dialog"  aria-labelledby="appTpyeModalLabel" aria-hidden="true">
           <div class="modal-dialog">
              <div class="modal-content col-md-10 col-md-push-1">
                 <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                          &times;
                    </button>
                    <h4 class="modal-title">
                       工具分类
                    </h4>
                 </div>

                 <div class="modal-body" style=" text-align:center">
                     <form style="text-align:left" id="appTypeForm" class="form-horizontal" role="form" action="__MODULE__/Admin/addUpdateToolCatalog" method="post" >
<!-----------模态框的表格------------->
			<input type="text"  class="form-control input-sm" style="display:none;" id="cat_id" name="cat_id">
			<div class="form-group user_form_height">
                <label class="col-sm-3 user_label">图标</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="cat_icon" name="cat_icon">
                </div>
                <!--上传文件-->
                <span class="btn btn-success fileinput-button btn-sm col-md-2" style="width: 60px;">
                    <i class="glyphicon glyphicon-upload"></i>
                    <span>上传</span>
                    <input id="uploadAppType" type="file" name="uploadAppType">
                </span>
                <!--上传文件结束-->
            </div>
            
            <div class="form-group user_form_height">
                <label class="col-sm-3 user_label">类型名</label>
                <div class="col-sm-7">
                <input type="text"  class="form-control input-sm" required id="cat_name" name="cat_name">
                </div>
            </div>
            
            <div class="form-group">
                <label class="col-sm-3 user_label">描述</label>
                <div class="col-sm-7">
                <textarea class="form-control" rows="3" id="cat_remark" name="cat_remark"></textarea>
                </div>
            </div>
            
		 <div class="modal-footer">
             
            <button type="submit" id="submitAppType"  class="btn btn-primary">
            	提交
            </button>
            <button type="button" id="cancel" class="btn btn-default" data-dismiss="modal">
               取消
            </button>
         </div>
<!-----------模态框的表格结束------------->                
                     </form>
                 </div>   
              </div>
        </div>
        </div>
<!---------------------------------模态框结束--------------------------------------------->           
<!------------------------------双击工具类型的项，出现为工具添加类型的模态框（table）------------------------------------->                
        <div class="modal fade" id="existAppModal" tabindex="-1" role="dialog"  aria-labelledby="existAppModalLabel" aria-hidden="true">
           <div class="modal-dialog"   style="width: 1200px">
              <div class="modal-content col-md-10 col-md-push-1" >
                 <div class="modal-header">
                 <input type='hidden' id='CAT_ID' name='CAT_ID'></input>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                          &times;
                    </button>
                    <h4 class="modal-title">
                       类别：<span id="selectedType"></span>
                    </h4>
                 </div>

                 <div class="modal-body" style=" text-align:center">
                     <div id="existAppDiv" class=" panel panel-default container col-md-6">
                        <div id="existAppToolbar">
                        	<p  style="font-size: 15px; padding-left:0px; padding-right:0px; text-align:left;">该类别已有工具</p>
                           
                        </div>

                    <table data-toggle="table"
                    		   data-url="__MODULE__/Admin/listCatTools"
                               data-toolbar="#existAppToolbar"
                               data-search="false"
                               data-click-to-select="true"
                               data-show-refresh="false"
                               data-height="350"
                               data-show-columns="true"
                               data-side-pagination="server"
                     
                               data-show-footer="false"
                               
                         id="existAppTable"
                               >
                        <thead>
                        <tr>
                            <th data-field="state" data-checkbox="true" ></th>
                            <th data-field="id" data-align="center" data-visible="false">工具id</th>
                            <th data-field=tool_name data-align="center" data-sortable="true" data-width="180" data-class="appType_hide" > 工具名</th>
                            <th data-field="tool_abstract" data-align="center" data-width="300"  data-sortable="true" data-class="appType_hide" >简介</th>
                            <th data-field="instruction_path"  data-align="center" data-width="140" data-sortable="true" data-class="appType_hide">文档</th>

                        </tr>
                        </thead>
                    </table>
                    
                    </div>
                <!------------右边的工具列表（简化table）---------->
                	<div id="allAppDiv" class=" panel panel-default container col-md-6">
                        <div id="allAppToolbar">
                        	<p  style="font-size: 15px; padding-left:0px; padding-right:0px; text-align:left;">工具列表</p>
                           
                        </div>

                    <table data-toggle="table"
                    		   data-url="__MODULE__/Admin/listTools"
                    		   data-side-pagination="server"
                               data-toolbar="#allAppToolbar"
                               data-search="true"
                               data-click-to-select="true"
                               data-show-refresh="true"
                               data-height="350"
                               

                               data-show-footer="false"
                               
                         id="allAppTable"
                               >
                        <thead>
                        <tr>
                             <th data-field="state" data-checkbox="true"></th>
                            <th data-field="id"  data-visible="false">工具id</th>
                            <th data-field="tool_name" data-align="center" data-width="180" data-sortable="true" data-class="allApp_hide">工具名</th>
                            <th data-field="tool_abstract" data-align="center" data-sortable="true" data-width="300" data-class="allApp_hide">工具介绍</th>
                            <th data-field="cat_name"  data-align="center" data-width="140" data-sortable="true" data-class="allApp_hide">类别</th>
                            
                        </tr>
                        </thead>
                    </table>
                    
                     
                    
                    </div>
                 <!------------右边的工具列表结束---------->
                 </div>  
                 
                 <div class="modal-footer" style="text-align:center;">
             
                    <button type="submit" id="addAppToExist"  class="btn btn-primary">
                        <i style="color: rgb( #FFF); font-size: 12px;"  class="glyphicon glyphicon-arrow-left"></i>&nbsp;&nbsp;添加工具
                    </button>
                    <button type="button" id="cancel" class="btn btn-default" data-dismiss="modal" style="margin-left:50px;">
                       取消
                    </button>
                 </div>
                  
              </div>
        </div>
        </div>
<!---------------------------------模态框结束---------------------------------------------> 
<!--账号管理结束--> 
</div>
<script>
$(function(){
	
	$(".bars").addClass("col-md-6");
	$(".bars").attr("style","padding-left:0px;");
	//列表添加删除按钮
	$("#appListDiv button[name='paginationSwitch']").after('<button class="btn btn-default" title="trash" name="trash" id="removeApp"><i class="glyphicon glyphicon-trash icon-trash"></i></button>');
	$("#appParamsDiv button[name='paginationSwitch']").after('<button class="btn btn-default" title="trash" name="trash" id="removeAppParam"><i class="glyphicon glyphicon-trash icon-trash"></i></button>');
	$("#appTypeListDiv button[name='paginationSwitch']").after('<button class="btn btn-default" title="trash" name="trash" id="removeAppType"><i class="glyphicon glyphicon-trash icon-trash"></i></button>');
	$("#existAppDiv button[data-toggle='dropdown']").after('<button class="btn btn-default" title="trash" name="trash" id="removeExistApp"><i class="glyphicon glyphicon-trash icon-trash"></i></button>');
	//缩短搜索框长度
	$("#existAppDiv input[placeholder='搜索']").attr("style","width: 80px;");
	$("#allAppDiv input[placeholder='搜索']").attr("style","width: 80px;");
	
	
	
//添加点击函数 这里直接写入了remove所用的参数，第一个参数是当前的表格id，第二个是网后台传的id，最后是向后台发送的地址
	$("#removeApp").click(function(){
		remove('appListTable','id','__MODULE__/Admin/delTools');
		$("#appList_ck_num").text(0);
		});
		
	$("#removeAppParam").click(function(){
		var toolId = $("#toolId").val();
		remove('appParamsTable','pid','__MODULE__/Admin/modifyToolParam/oper/del',{query:{pid:toolId}});
		$("#appParams_ck_num").text(0);			
		});
		
	$("#removeAppType").click(function(){
		remove('appTypeListTable','cat_id','__MODULE__/Admin/manageToolCatlogs/oper/del');
		$("#appType_ck_num").text(0);			
		});
	
	$("#removeExistApp").click(function(){

		var number = checkedNum("existAppTable");//选中个数
		var catid = $('#CAT_ID').val();
		if(number == 0){ 
			alert("您还未选中任何项！")
			}
		else{
			var r=confirm("您确定要删除这" + number + "项吗？");
			if (r==true)
			  {	 var appType = $("#selectedType").text();
				 var appId =  getIdSelections("existAppTable","id")   //该函数获取ID
				 $.ajax({
						url:'__MODULE__/Admin/catDelTools',  
						type:'post',
						data:{ids:appId},    //向后台传要删除的app的id和所属的app类型
						dataType: "json",
						success:function(data) {
							if(data['status']=='ERROR'){    //请求成功但没有执行成功
					//			$("#existAppTable").bootstrapTable('refresh');      //刷新
					//			$("#allAppTable").bootstrapTable('refresh');
								alert(data['data']);
							}else{
								$("#existAppTable").bootstrapTable('refresh', {query:{cat_id:catid}});
								$("#allAppTable").bootstrapTable('refresh');
								alert("删除成功！");								
							}
						 },    
						 error : function(XMLHttpRequest) {
						   alert(XMLHttpRequest.status +' '+ XMLHttpRequest.statusText);    
						 }
					});  
			  }
		}

});   
					
		
	//点击刷新按钮进行刷新时，已选项置零
	$("#appListDiv button[name='refresh']").click(function(){
		$("#appList_ck_num").text(0);
	});
	$("#appParamsDiv button[name='refresh']").click(function(){
		$("#appParams_ck_num").text(0);
	});
	$("#appTypeListDiv button[name='refresh']").click(function(){
		$("#appType_ck_num").text(0);
	});

	//文件上传
	$("#uploadAppIcon").click(function(){
		uploadFile('json/uploadUrl.json','uploadAppIcon','#appListModal #icon')
	});
	
	$("#uploadAppDocument").click(function(){
		uploadFile('json/uploadUrl.json','uploadAppDocument','#appListModal #document')
	});

	$("#uploadAppType").click(function(){
		uploadFile('json/uploadUrl.json','uploadAppType','#appTypeForm #typeIcon')
	});
});
</script>

</body>
</html>



